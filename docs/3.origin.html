<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="by: Nina Branten" />


<title>3. Origin</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="tweaks.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    My journal
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="lab1.html">Week 1</a>
    </li>
    <li>
      <a href="week-2-plotting.html">Week 2</a>
    </li>
    <li>
      <a href="RU_lab.html">Week 3/4 - RU</a>
    </li>
    <li>
      <a href="RSiena_tutorial.html">Week 4 - RSiena tutorial</a>
    </li>
    <li>
      <a href="1.names.html">1. Names</a>
    </li>
    <li>
      <a href="2.gender.html">2. Gender</a>
    </li>
    <li>
      <a href="3.origin.html">3. Origin</a>
    </li>
    <li>
      <a href="4.scholar.html">4. Scholar</a>
    </li>
    <li>
      <a href="5.RU_etni_age.html">5. RU ethnicity &amp; age</a>
    </li>
    <li>
      <a href="5.UU_etni_age.html">5. UU ethnicity &amp; age</a>
    </li>
    <li>
      <a href="6.RU_Array.html">6. RU array</a>
    </li>
    <li>
      <a href="6.UU_Array.html">6. UU array</a>
    </li>
    <li>
      <a href="7.RU_descriptives.html">7. RU descriptives</a>
    </li>
    <li>
      <a href="7.UU_descriptives.html">7. UU descriptives</a>
    </li>
    <li>
      <a href="8.RU_regression.html">8. RU regression</a>
    </li>
    <li>
      <a href="8.UU_regression.html">8. UU regression</a>
    </li>
    <li>
      <a href="9.RU_RSiena.html">9. RU RSiena</a>
    </li>
    <li>
      <a href="9.UU_RSiena.html">9. UU RSiena</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Research Question
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="RQ1.html">first attempt</a>
    </li>
    <li>
      <a href="RQ2.html">second attempt</a>
    </li>
    <li>
      <a href="RQ3.html">third attempt</a>
    </li>
    <li>
      <a href="RQ4.html">fourth attempt</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Final report
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Introduction.html">Introduction</a>
    </li>
    <li>
      <a href="DataMethods.html">Data &amp; Methods</a>
    </li>
    <li>
      <a href="Analysis_descriptives.html">Analysis: descriptives</a>
    </li>
    <li>
      <a href="Regression.html">Analysis: regression</a>
    </li>
    <li>
      <a href="9.RU_RSiena.html">Analysis: RU RSiena</a>
    </li>
    <li>
      <a href="9.UU_RSiena.html">Analysis: UU RSiena</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/JochemTolsma/labjournal">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">3. Origin</h1>
<h4 class="author">by: Nina Branten</h4>

</div>


<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<div id="getting-started" class="section level1" number="1">
<h1><span class="header-section-number">1</span> getting started</h1>
<pre class="r test"><code>#start with clean workspace 
rm(list=ls())
load(&quot;./data/names_df_v20221005.RData&quot;)</code></pre>
</div>
<div id="packages" class="section level1" number="2">
<h1><span class="header-section-number">2</span> packages</h1>
<pre class="r test"><code>library(data.table) 
library(tidyverse) 
require(xml2)
require(rvest)
require(devtools)
require(scholar)
require(stringi)</code></pre>
<p>andere strategie. alle nobiliary particles er af. dan zonder deze
door databank. dan indien geen info, via particles NL-identiteit (of
spaans of Duits of arabisch)</p>
<pre class="r test"><code>lastname_df &lt;- names_df
lastname_df$lastname2 &lt;- as.character(str_split(lastname_df$lastname, pattern=&quot;,&quot;, n = 2, simplify = TRUE)[,1])
lastname_df$np &lt;- as.character(str_split(lastname_df$lastname, pattern=&quot;,&quot;, n = 2, simplify = TRUE)[,2])</code></pre>
<pre class="r test"><code># creating URLs: origin
flaname &lt;- function(x){
    paste(toupper(substring(x, 1, 1)),
          tolower(substring(x, 2, nchar(x))),
          sep = &quot;&quot;)
}
lastname_df$lastname2 &lt;- flaname(lastname_df$lastname2)

lastname_df$name_origin &lt;- paste0(&quot;https://www.cbgfamilienamen.nl/nfb/detail_naam.php?gba_naam=&quot;,
                                lastname_df$lastname2,
                                &quot;&amp;nfd_naam=&quot;,
                                lastname_df$lastname2,
                                &quot;&amp;info=analyse+en+verklaring&amp;operator=eq&amp;taal=&quot;)</code></pre>
<p><a
href="https://www.cbgfamilienamen.nl/nfb/detail_naam.php?gba_naam=tolsma&amp;gba_naam=Tolsma&amp;nfd_naam=&amp;info=analyse+en+verklaring&amp;operator=eq&amp;taal="
class="uri">https://www.cbgfamilienamen.nl/nfb/detail_naam.php?gba_naam=tolsma&amp;gba_naam=Tolsma&amp;nfd_naam=&amp;info=analyse+en+verklaring&amp;operator=eq&amp;taal=</a></p>
<p>#lastname_df$name_origin[14] <a
href="https://www.cbgfamilienamen.nl/nfb/detail_naam.php?gba_naam="
class="uri">https://www.cbgfamilienamen.nl/nfb/detail_naam.php?gba_naam=</a>
Tolsma &amp;nfd_naam= Tolsma
&amp;info=analyse+en+verklaring&amp;operator=eq&amp;taal=</p>
<p>#<a
href="https://www.cbgfamilienamen.nl/nfb/detail_naam.php?gba_lcnaam=kraaykamp&amp;gba_naam=Kraaykamp&amp;nfd_naam=Kraaijkamp%20(y)&amp;operator=eq&amp;taal="
class="uri">https://www.cbgfamilienamen.nl/nfb/detail_naam.php?gba_lcnaam=kraaykamp&amp;gba_naam=Kraaykamp&amp;nfd_naam=Kraaijkamp%20(y)&amp;operator=eq&amp;taal=</a></p>
<p>hier slaan we alles op</p>
<pre class="r test"><code>name_originl &lt;- list()
table_originl &lt;- list()
time &lt;- 0.1</code></pre>
</div>
<div id="crucical-scrape-loop" class="section level1" number="3">
<h1><span class="header-section-number">3</span> crucical scrape
loop</h1>
<pre class="r test"><code>for (i in 1:nrow(lastname_df)) {
  print(i)
  Sys.sleep(time)
  tryCatch({ 
    name_originl[[i]]  &lt;- read_html(lastname_df[i, c(&quot;name_origin&quot;)])
    table_originl[[i]] &lt;- name_originl[[i]] %&gt;% html_table()
  }, 
    warning = function(w) {
        cat(&quot;WARNING:&quot;, conditionMessage(w), &quot;\n&quot;) #WARNING message
    },
    error=function(e){
      err &lt;- conditionMessage(e)
      cat(&quot;Error:&quot;, conditionMessage(e), &quot;\n&quot;) #ERROR message
    }  
  )
}</code></pre>
<p>en vanaf hier is het eigenlijk alleen maar opschonen.</p>
<pre class="r test"><code>origin_txt &lt;- list()
for (i in 1:length(name_originl)) {
    origin_txt [[i]] &lt;- name_originl[[i]] %&gt;% html_text() %&gt;% as.character()
}</code></pre>
<pre class="r test"><code># Get out the relevant origin information from the xml lists
origin_ln &lt;- list()

for (i in 1:length(name_originl)) {
  origin_ln[[i]] &lt;- name_originl[[i]] %&gt;% html_nodes(&quot;div&quot;) %&gt;% rvest::html_text()
  origin_ln[[i]] &lt;- origin_ln[[i]][[3]]
}

# Remove mess
for (i in 1:length(origin_ln)) {
  origin_ln[[i]] &lt;- gsub(&quot;\\t&quot;, &quot; &quot;, origin_ln[[i]])
  origin_ln[[i]] &lt;- gsub(&quot;\\n&quot;, &quot; &quot;, origin_ln[[i]])
}

# Flatten nested structure of the origin information
#origin_ln &lt;- rbind(flatten(origin_ln))</code></pre>
<pre class="r test"><code># Detaching the names and origin info for easier data handling
origin &lt;- unlist(origin_ln)



origin &lt;- str_extract_all(origin, &quot;varianten(.*?)©&quot;)

# Origin information is usually mentioned after &quot;verklaring&quot; or &quot;kenmerken&quot;
origin &lt;- str_remove_all(origin, &quot;varianten&quot;)
origin &lt;- str_remove_all(origin, &quot;CBG Bronnen&quot;)
origin &lt;- str_remove_all(origin, &quot;catalogus&quot;)
origin &lt;- str_remove_all(origin, &quot;©&quot;)


verklaring &lt;- str_remove_all(origin, &quot;kenmerken:(.*?)$&quot;)
kenmerken &lt;- str_extract_all(origin, &quot;kenmerken:(.*?)$&quot;)
kenmerken &lt;- str_remove_all(kenmerken, &quot;specifieke componenten:(.*?)$&quot;)
sc &lt;- str_extract_all(origin, &quot;specifieke componenten:(.*?)$&quot;) # Not directly relevant to us, but does mean that the name has a webpage


# Make into a neat dataframe with the names attached
verklaring &lt;- trimws(verklaring, which = &quot;both&quot;)
kenmerken &lt;- trimws(kenmerken, which = &quot;both&quot;)
sc &lt;- trimws(sc, which = &quot;both&quot;)
vk &lt;- data.frame(lastname_df$id,lastname_df$lastname, verklaring, kenmerken, sc)</code></pre>
</div>
<div id="separating-names-with-dutch-unknown-origin"
class="section level1" number="4">
<h1><span class="header-section-number">4</span> Separating names with
Dutch &amp; unknown origin</h1>
<p>Next, we identify those names for which no additional information was
found. This is important to distinguish Dutch names from names with
unknown origins.</p>
<ul>
<li>Dutch names: no label indicating that the name is Dutch, but some
other information available on name origin</li>
<li>Unknown names: web page cannot be found, so origin information is
empty.</li>
</ul>
<pre class="r test"><code># Identify last names that could not be found
vk &lt;- vk %&gt;%
  mutate(verklaring = ifelse(verklaring==&quot;&quot;, 0, verklaring), 
         kenmerken = ifelse(kenmerken==&quot;character(0)&quot;, 0, kenmerken),
         sc = ifelse(sc==&quot;character(0)&quot;, 0, sc),
         no_info = nchar(verklaring) + nchar(kenmerken) + nchar(sc))

vk &lt;- vk %&gt;%
  mutate(no_info = ifelse(no_info==3, 1, 0), 
         verklaring = ifelse(verklaring==0, NA, verklaring),
         kenmerken = ifelse(kenmerken==0, NA, kenmerken))
# If there is no text in verklaring or kenmerken, the name could not be found in the databases. </code></pre>
</div>
<div id="extracting-specific-origin-information" class="section level1"
number="5">
<h1><span class="header-section-number">5</span> Extracting specific
origin information</h1>
<p>There are three main ways to get information about the origin of last
names:</p>
<ol style="list-style-type: decimal">
<li><p>Under “kenmerken”, last names are assigned clickable tags. These
tags include unspecified foreign name tags (“andere taal”), as well as
specific foreign origins of the name (“Franse naam”, “Indische naam”).
-&gt; origin1 + origin4</p></li>
<li><p>Several names have more extensively written out stories behind
the name, under “verklaring”. A number of names contain detailed (either
country-level or regional) origins, usually in the form of “De naam
[xyz] is afkomstig uit [country]”. -&gt; origin2</p></li>
<li><p>Some names have origin information under “verklaring” in the form
of the linguistic origins of the name. This can be country specific
(e.g. Chinese name), but it can also apply to multiple countries when
the language is spoken in more than 1 countries (e.g. Spanish name).
-&gt; origin3</p></li>
</ol>
<p>In het script hieronder gaat ergens iets fout. Daarom heb ik
etniciteit uiteindelijk met de hand uitgerekend.</p>
<pre class="r test"><code># Step 1: extracting origin tags from kenmerken
vk &lt;- vk %&gt;%
  mutate(origin1 = str_extract(kenmerken, &quot;[:upper:]([:lower:]{2,}) naam&quot;))

# Note: sometimes multiple origins are mentioned. Currently, I only extract the first one. Otherwise, we should use str_extract_all. 



# Step 2: extracting origin info from verklaring 
vk &lt;- vk %&gt;%
  mutate(origin2 = ifelse(as.numeric(str_detect(verklaring, &quot;afkomstig uit&quot;)) == 1, 
         str_remove(verklaring, &quot;.*afkomstig uit&quot;), NA))


# Step 3: extracting additional origin info from verklaring
vk &lt;- vk %&gt;%
  mutate(origin3 = str_extract(verklaring, &quot;[:upper:]([:lower:]{2,}) (achter)?(familie)?(beroeps)?naam&quot;))



# Finally, we clean up the origin information extracted above

# Origin1: already neat
vk$origin1 &lt;- str_remove(vk$origin1, &quot;Joodse naam&quot;) # can be Dutch &amp; non-Dutch

# Origin2: messy
vk$origin2 &lt;- str_remove(vk$origin2, &quot;\\..*&quot;) # remove extra info in the following sentence 
vk$origin2 &lt;- str_remove(vk$origin2, &quot;\\;.*&quot;) # remove extra info in the following sentence 
vk$origin2 &lt;- str_remove(vk$origin2, &quot;\\(.*&quot;) # remove extra info in the following sentence 


vk$dpg &lt;- as.numeric(str_detect(vk$origin2, &quot;(dorp)|(plaats)|(gemeente)|(graafschap)|(stad)|(deel)|(Friesland)&quot;)) # origin info too regional 
vk &lt;- vk %&gt;% mutate(origin2 = ifelse((dpg==1), NA, origin2)) # removing regional origin info
vk &lt;- subset(vk, select = -dpg) # removing intermediate variable

# Sometimes, there were multiple countries mentioned. Take only the first:
vk$origin2 &lt;- str_remove(vk$origin2, &quot;\\,.*&quot;) # Only first
vk$origin2 &lt;- str_remove(vk$origin2, &quot;\\s(en).*&quot;) # Only first 
vk$origin2 &lt;- str_remove(vk$origin2, &quot;\\s(of).*&quot;) # Only first 


# Origin3: pretty neat
vk$origin3 &lt;- str_remove(vk$origin3, &quot;D(i)?e(ze)? (familie)?(achter)?(beroeps)?naam&quot;) # slipped through the regex
vk$origin3 &lt;- str_remove(vk$origin3, &quot;Een (familie)?(achter)?(beroeps)?naam&quot;) # slipped through the regex
vk$origin3 &lt;- str_remove(vk$origin3, &quot;Zijn (familie)?(achter)?(beroeps)?naam&quot;) # slipped through the regex
vk$origin3 &lt;- str_remove(vk$origin3, &quot;Als (familie)?(achter)?(beroeps)?naam&quot;) # slipped through the regex
vk$origin3 &lt;- str_remove(vk$origin3, &quot;Joodse (familie)?(achter)?naam&quot;)
vk$origin3 &lt;- str_remove(vk$origin3, &quot;Bijbelse (familie)?(achter)?naam&quot;)


# Setting empty origin variables to NA (Dutch or unfound foreign)
vk &lt;- vk %&gt;%
  mutate(origin1 = as.character(ifelse(origin1==&quot;&quot;|origin1==&quot;character(0)&quot;, NA, origin1)),
         origin2 = as.character(ifelse(origin2==&quot;&quot;|origin2==&quot;character(0)&quot;, NA, origin2)),
         origin3 = as.character(ifelse(origin3==&quot;&quot;|origin3==&quot;character(0)&quot;, NA, origin3)))



# Finally, the tag &quot;andere taal&quot; was used to distinguish foreign names of unknown origin from known Dutch names. 
vk &lt;- vk %&gt;%
  mutate(origin4 = ifelse((as.numeric(str_detect(kenmerken, &quot;andere taal&quot;))==1), &quot;non-Dutch&quot;, NA))

voorvoegselsnl &lt;- c(&quot;&#39;t&quot;, &quot;d&#39;&quot;, &quot;de&quot;, &quot;de la&quot;, &quot;den&quot;, &quot;del&quot;, &quot;der&quot;, &quot;des&quot;, &quot;in &#39;t&quot;, &quot;op de&quot;, &quot;op den&quot;, &quot;ten&quot;, &quot;ter&quot;, &quot;tes&quot;, &quot;van&quot;, &quot;van &#39;t&quot;, &quot;van de&quot; , &quot;van der&quot;, &quot;van den&quot;) 

vk$nl &lt;- 0

for (i in 1: length(vk$lastname_df.lastname)) {
  if (sum(str_detect(lastname_df$np[i], voorvoegselsnl))&gt;0) {
    vk$nl[i] &lt;- 1
  }
}

vk$dutch &lt;- ifelse(((vk$no_info==1 | vk$no_info==&quot;non_Dutch&quot;) &amp; !vk$nl==1), 0, 1)
names(vk)
vk %&gt;% select(c(&quot;lastname_df.id&quot;, &quot;lastname_df.lastname&quot;, &quot;dutch&quot;))</code></pre>
<pre class="r test"><code>save(vk, file=&quot;vk20221006.RData&quot;) </code></pre>
<pre class="r test"><code>names_df$dutch &lt;- vk$dutch</code></pre>
<pre class="r test"><code>save(names_df, file=&quot;names_df_v20221006.RData&quot;) </code></pre>
<p>Ik zou alles waar <code>no_info</code> op 1 staat of waar
<code>origin4</code> op “non-Dutch” staat coderen als buitenlands!</p>
</div>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIjMuIE9yaWdpbiINCmF1dGhvcjogImJ5OiBOaW5hIEJyYW50ZW4iDQpiaWJsaW9ncmFwaHk6IHJlZmVyZW5jZXMuYmliDQotLS0NCg0KDQoNCmBgYHtyLCBpbnN0YWxsIHJlbW90ZWx5LCBnbG9iYWxzZXR0aW5ncywgZWNobz1GQUxTRSwgd2FybmluZz1GQUxTRSwgcmVzdWx0cz0naGlkZScsIGV2YWw9RkFMU0V9DQppbnN0YWxsLnBhY2thZ2VzKCJyZW1vdGVzIikNCnJlbW90ZXM6Omluc3RhbGxfZ2l0aHViKCJybGVzdXIva2xpcHB5IikNCmBgYCANCg0KYGBge3IsIGdsb2JhbHNldHRpbmdzLCBlY2hvPUZBTFNFLCB3YXJuaW5nPUZBTFNFLCByZXN1bHRzPSdoaWRlJ30NCmxpYnJhcnkoa25pdHIpDQpsaWJyYXJ5KHJnbCkNCg0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFKQ0Kb3B0c19jaHVuayRzZXQodGlkeS5vcHRzPWxpc3Qod2lkdGguY3V0b2ZmPTEwMCksdGlkeT1UUlVFLCB3YXJuaW5nID0gRkFMU0UsIG1lc3NhZ2UgPSBGQUxTRSxjb21tZW50ID0gIiM+IiwgY2FjaGU9VFJVRSwgY2xhc3Muc291cmNlPWMoInRlc3QiKSwgY2xhc3Mub3V0cHV0PWMoInRlc3QyIikpDQpvcHRpb25zKHdpZHRoID0gMTAwKQ0KcmdsOjpzZXR1cEtuaXRyKCkNCg0KDQoNCmNvbG9yaXplIDwtIGZ1bmN0aW9uKHgsIGNvbG9yKSB7c3ByaW50ZigiPHNwYW4gc3R5bGU9J2NvbG9yOiAlczsnPiVzPC9zcGFuPiIsIGNvbG9yLCB4KSB9DQoNCmBgYA0KDQpgYGB7ciBrbGlwcHksIGVjaG89RkFMU0UsIGluY2x1ZGU9VFJVRX0NCmtsaXBweTo6a2xpcHB5KHBvc2l0aW9uID0gYygndG9wJywgJ3JpZ2h0JykpDQoja2xpcHB5OjprbGlwcHkoY29sb3IgPSAnZGFya3JlZCcpDQoja2xpcHB5OjprbGlwcHkodG9vbHRpcF9tZXNzYWdlID0gJ0NsaWNrIHRvIGNvcHknLCB0b29sdGlwX3N1Y2Nlc3MgPSAnRG9uZScpDQpgYGANCg0KIyBnZXR0aW5nIHN0YXJ0ZWQNCg0KYGBge3IsIGV2YWw9RkFMU0V9DQojc3RhcnQgd2l0aCBjbGVhbiB3b3Jrc3BhY2UgDQpybShsaXN0PWxzKCkpDQpsb2FkKCIuL2RhdGEvbmFtZXNfZGZfdjIwMjIxMDA1LlJEYXRhIikNCmBgYA0KDQoNCg0KIyBwYWNrYWdlcw0KDQpgYGB7cn0NCmxpYnJhcnkoZGF0YS50YWJsZSkgDQpsaWJyYXJ5KHRpZHl2ZXJzZSkgDQpyZXF1aXJlKHhtbDIpDQpyZXF1aXJlKHJ2ZXN0KQ0KcmVxdWlyZShkZXZ0b29scykNCnJlcXVpcmUoc2Nob2xhcikNCnJlcXVpcmUoc3RyaW5naSkNCg0KYGBgDQoNCmFuZGVyZSBzdHJhdGVnaWUuIGFsbGUgbm9iaWxpYXJ5IHBhcnRpY2xlcyBlciBhZi4NCmRhbiB6b25kZXIgZGV6ZSBkb29yIGRhdGFiYW5rLiANCmRhbiBpbmRpZW4gZ2VlbiBpbmZvLCB2aWEgcGFydGljbGVzIE5MLWlkZW50aXRlaXQgKG9mIHNwYWFucyBvZiBEdWl0cyBvZiBhcmFiaXNjaCkNCg0KYGBge3IsIGV2YWw9RkFMU0V9DQpsYXN0bmFtZV9kZiA8LSBuYW1lc19kZg0KbGFzdG5hbWVfZGYkbGFzdG5hbWUyIDwtIGFzLmNoYXJhY3RlcihzdHJfc3BsaXQobGFzdG5hbWVfZGYkbGFzdG5hbWUsIHBhdHRlcm49IiwiLCBuID0gMiwgc2ltcGxpZnkgPSBUUlVFKVssMV0pDQpsYXN0bmFtZV9kZiRucCA8LSBhcy5jaGFyYWN0ZXIoc3RyX3NwbGl0KGxhc3RuYW1lX2RmJGxhc3RuYW1lLCBwYXR0ZXJuPSIsIiwgbiA9IDIsIHNpbXBsaWZ5ID0gVFJVRSlbLDJdKQ0KYGBgDQoNCg0KYGBge3IsIGV2YWw9RkFMU0V9DQojIGNyZWF0aW5nIFVSTHM6IG9yaWdpbg0KZmxhbmFtZSA8LSBmdW5jdGlvbih4KXsNCiAgICBwYXN0ZSh0b3VwcGVyKHN1YnN0cmluZyh4LCAxLCAxKSksDQogICAgICAgICAgdG9sb3dlcihzdWJzdHJpbmcoeCwgMiwgbmNoYXIoeCkpKSwNCiAgICAgICAgICBzZXAgPSAiIikNCn0NCmxhc3RuYW1lX2RmJGxhc3RuYW1lMiA8LSBmbGFuYW1lKGxhc3RuYW1lX2RmJGxhc3RuYW1lMikNCg0KbGFzdG5hbWVfZGYkbmFtZV9vcmlnaW4gPC0gcGFzdGUwKCJodHRwczovL3d3dy5jYmdmYW1pbGllbmFtZW4ubmwvbmZiL2RldGFpbF9uYWFtLnBocD9nYmFfbmFhbT0iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0bmFtZV9kZiRsYXN0bmFtZTIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICImbmZkX25hYW09IiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdG5hbWVfZGYkbGFzdG5hbWUyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiJmluZm89YW5hbHlzZStlbit2ZXJrbGFyaW5nJm9wZXJhdG9yPWVxJnRhYWw9IikNCmBgYA0KDQpodHRwczovL3d3dy5jYmdmYW1pbGllbmFtZW4ubmwvbmZiL2RldGFpbF9uYWFtLnBocD9nYmFfbmFhbT10b2xzbWEmZ2JhX25hYW09VG9sc21hJm5mZF9uYWFtPSZpbmZvPWFuYWx5c2UrZW4rdmVya2xhcmluZyZvcGVyYXRvcj1lcSZ0YWFsPQ0KDQojbGFzdG5hbWVfZGYkbmFtZV9vcmlnaW5bMTRdDQpodHRwczovL3d3dy5jYmdmYW1pbGllbmFtZW4ubmwvbmZiL2RldGFpbF9uYWFtLnBocD9nYmFfbmFhbT0NCiAgVG9sc21hDQombmZkX25hYW09DQogIFRvbHNtYQ0KJmluZm89YW5hbHlzZStlbit2ZXJrbGFyaW5nJm9wZXJhdG9yPWVxJnRhYWw9DQoNCiNodHRwczovL3d3dy5jYmdmYW1pbGllbmFtZW4ubmwvbmZiL2RldGFpbF9uYWFtLnBocD9nYmFfbGNuYWFtPWtyYWF5a2FtcCZnYmFfbmFhbT1LcmFheWthbXAmbmZkX25hYW09S3JhYWlqa2FtcCUyMCh5KSZvcGVyYXRvcj1lcSZ0YWFsPQ0KDQoNCmhpZXIgc2xhYW4gd2UgYWxsZXMgb3ANCmBgYHtyLCBldmFsPUZBTFNFfQ0KbmFtZV9vcmlnaW5sIDwtIGxpc3QoKQ0KdGFibGVfb3JpZ2lubCA8LSBsaXN0KCkNCnRpbWUgPC0gMC4xDQpgYGANCg0KIyBjcnVjaWNhbCBzY3JhcGUgbG9vcA0KIA0KYGBge3IsIGV2YWw9RkFMU0V9DQoNCmZvciAoaSBpbiAxOm5yb3cobGFzdG5hbWVfZGYpKSB7DQogIHByaW50KGkpDQogIFN5cy5zbGVlcCh0aW1lKQ0KICB0cnlDYXRjaCh7IA0KICAgIG5hbWVfb3JpZ2lubFtbaV1dICA8LSByZWFkX2h0bWwobGFzdG5hbWVfZGZbaSwgYygibmFtZV9vcmlnaW4iKV0pDQogICAgdGFibGVfb3JpZ2lubFtbaV1dIDwtIG5hbWVfb3JpZ2lubFtbaV1dICU+JSBodG1sX3RhYmxlKCkNCiAgfSwgDQogICAgd2FybmluZyA9IGZ1bmN0aW9uKHcpIHsNCiAgICAgICAgY2F0KCJXQVJOSU5HOiIsIGNvbmRpdGlvbk1lc3NhZ2UodyksICJcbiIpICNXQVJOSU5HIG1lc3NhZ2UNCiAgICB9LA0KICAgIGVycm9yPWZ1bmN0aW9uKGUpew0KICAgICAgZXJyIDwtIGNvbmRpdGlvbk1lc3NhZ2UoZSkNCiAgICAgIGNhdCgiRXJyb3I6IiwgY29uZGl0aW9uTWVzc2FnZShlKSwgIlxuIikgI0VSUk9SIG1lc3NhZ2UNCiAgICB9ICANCiAgKQ0KfQ0KYGBgDQoNCmVuIHZhbmFmIGhpZXIgaXMgaGV0IGVpZ2VubGlqayBhbGxlZW4gbWFhciBvcHNjaG9uZW4uIA0KYGBge3IsIGV2YWw9RkFMU0V9DQpvcmlnaW5fdHh0IDwtIGxpc3QoKQ0KZm9yIChpIGluIDE6bGVuZ3RoKG5hbWVfb3JpZ2lubCkpIHsNCiAgICBvcmlnaW5fdHh0IFtbaV1dIDwtIG5hbWVfb3JpZ2lubFtbaV1dICU+JSBodG1sX3RleHQoKSAlPiUgYXMuY2hhcmFjdGVyKCkNCn0NCg0KYGBgDQoNCmBgYHtyLCBldmFsPUZBTFNFfQ0KIyBHZXQgb3V0IHRoZSByZWxldmFudCBvcmlnaW4gaW5mb3JtYXRpb24gZnJvbSB0aGUgeG1sIGxpc3RzDQpvcmlnaW5fbG4gPC0gbGlzdCgpDQoNCmZvciAoaSBpbiAxOmxlbmd0aChuYW1lX29yaWdpbmwpKSB7DQogIG9yaWdpbl9sbltbaV1dIDwtIG5hbWVfb3JpZ2lubFtbaV1dICU+JSBodG1sX25vZGVzKCJkaXYiKSAlPiUgcnZlc3Q6Omh0bWxfdGV4dCgpDQogIG9yaWdpbl9sbltbaV1dIDwtIG9yaWdpbl9sbltbaV1dW1szXV0NCn0NCg0KIyBSZW1vdmUgbWVzcw0KZm9yIChpIGluIDE6bGVuZ3RoKG9yaWdpbl9sbikpIHsNCiAgb3JpZ2luX2xuW1tpXV0gPC0gZ3N1YigiXFx0IiwgIiAiLCBvcmlnaW5fbG5bW2ldXSkNCiAgb3JpZ2luX2xuW1tpXV0gPC0gZ3N1YigiXFxuIiwgIiAiLCBvcmlnaW5fbG5bW2ldXSkNCn0NCg0KIyBGbGF0dGVuIG5lc3RlZCBzdHJ1Y3R1cmUgb2YgdGhlIG9yaWdpbiBpbmZvcm1hdGlvbg0KI29yaWdpbl9sbiA8LSByYmluZChmbGF0dGVuKG9yaWdpbl9sbikpDQoNCmBgYA0KDQoNCmBgYHtyIGV4dHJhY3RpbmctdmVya2xhcmluZy1rZW5tZXJrZW4sIGV2YWw9RkFMU0V9DQoNCiMgRGV0YWNoaW5nIHRoZSBuYW1lcyBhbmQgb3JpZ2luIGluZm8gZm9yIGVhc2llciBkYXRhIGhhbmRsaW5nDQpvcmlnaW4gPC0gdW5saXN0KG9yaWdpbl9sbikNCg0KDQoNCm9yaWdpbiA8LSBzdHJfZXh0cmFjdF9hbGwob3JpZ2luLCAidmFyaWFudGVuKC4qPynCqSIpDQoNCiMgT3JpZ2luIGluZm9ybWF0aW9uIGlzIHVzdWFsbHkgbWVudGlvbmVkIGFmdGVyICJ2ZXJrbGFyaW5nIiBvciAia2VubWVya2VuIg0Kb3JpZ2luIDwtIHN0cl9yZW1vdmVfYWxsKG9yaWdpbiwgInZhcmlhbnRlbiIpDQpvcmlnaW4gPC0gc3RyX3JlbW92ZV9hbGwob3JpZ2luLCAiQ0JHIEJyb25uZW4iKQ0Kb3JpZ2luIDwtIHN0cl9yZW1vdmVfYWxsKG9yaWdpbiwgImNhdGFsb2d1cyIpDQpvcmlnaW4gPC0gc3RyX3JlbW92ZV9hbGwob3JpZ2luLCAiwqkiKQ0KDQoNCnZlcmtsYXJpbmcgPC0gc3RyX3JlbW92ZV9hbGwob3JpZ2luLCAia2VubWVya2VuOiguKj8pJCIpDQprZW5tZXJrZW4gPC0gc3RyX2V4dHJhY3RfYWxsKG9yaWdpbiwgImtlbm1lcmtlbjooLio/KSQiKQ0Ka2VubWVya2VuIDwtIHN0cl9yZW1vdmVfYWxsKGtlbm1lcmtlbiwgInNwZWNpZmlla2UgY29tcG9uZW50ZW46KC4qPykkIikNCnNjIDwtIHN0cl9leHRyYWN0X2FsbChvcmlnaW4sICJzcGVjaWZpZWtlIGNvbXBvbmVudGVuOiguKj8pJCIpICMgTm90IGRpcmVjdGx5IHJlbGV2YW50IHRvIHVzLCBidXQgZG9lcyBtZWFuIHRoYXQgdGhlIG5hbWUgaGFzIGEgd2VicGFnZQ0KDQoNCiMgTWFrZSBpbnRvIGEgbmVhdCBkYXRhZnJhbWUgd2l0aCB0aGUgbmFtZXMgYXR0YWNoZWQNCnZlcmtsYXJpbmcgPC0gdHJpbXdzKHZlcmtsYXJpbmcsIHdoaWNoID0gImJvdGgiKQ0Ka2VubWVya2VuIDwtIHRyaW13cyhrZW5tZXJrZW4sIHdoaWNoID0gImJvdGgiKQ0Kc2MgPC0gdHJpbXdzKHNjLCB3aGljaCA9ICJib3RoIikNCnZrIDwtIGRhdGEuZnJhbWUobGFzdG5hbWVfZGYkaWQsbGFzdG5hbWVfZGYkbGFzdG5hbWUsIHZlcmtsYXJpbmcsIGtlbm1lcmtlbiwgc2MpDQoNCg0KYGBgDQoNCg0KDQojIFNlcGFyYXRpbmcgbmFtZXMgd2l0aCBEdXRjaCAmIHVua25vd24gb3JpZ2luDQpOZXh0LCB3ZSBpZGVudGlmeSB0aG9zZSBuYW1lcyBmb3Igd2hpY2ggbm8gYWRkaXRpb25hbCBpbmZvcm1hdGlvbiB3YXMgZm91bmQuIFRoaXMgaXMgaW1wb3J0YW50IHRvIGRpc3Rpbmd1aXNoIER1dGNoIG5hbWVzIGZyb20gbmFtZXMgd2l0aCB1bmtub3duIG9yaWdpbnMuDQoNCi0gRHV0Y2ggbmFtZXM6IG5vIGxhYmVsIGluZGljYXRpbmcgdGhhdCB0aGUgbmFtZSBpcyBEdXRjaCwgYnV0IHNvbWUgb3RoZXIgaW5mb3JtYXRpb24gYXZhaWxhYmxlIG9uIG5hbWUgb3JpZ2luDQotIFVua25vd24gbmFtZXM6IHdlYiBwYWdlIGNhbm5vdCBiZSBmb3VuZCwgc28gb3JpZ2luIGluZm9ybWF0aW9uIGlzIGVtcHR5LiANCg0KYGBge3Igb3JpZ2luLXVua25vd24sIGV2YWw9RkFMU0V9DQoNCiMgSWRlbnRpZnkgbGFzdCBuYW1lcyB0aGF0IGNvdWxkIG5vdCBiZSBmb3VuZA0KdmsgPC0gdmsgJT4lDQogIG11dGF0ZSh2ZXJrbGFyaW5nID0gaWZlbHNlKHZlcmtsYXJpbmc9PSIiLCAwLCB2ZXJrbGFyaW5nKSwgDQogICAgICAgICBrZW5tZXJrZW4gPSBpZmVsc2Uoa2VubWVya2VuPT0iY2hhcmFjdGVyKDApIiwgMCwga2VubWVya2VuKSwNCiAgICAgICAgIHNjID0gaWZlbHNlKHNjPT0iY2hhcmFjdGVyKDApIiwgMCwgc2MpLA0KICAgICAgICAgbm9faW5mbyA9IG5jaGFyKHZlcmtsYXJpbmcpICsgbmNoYXIoa2VubWVya2VuKSArIG5jaGFyKHNjKSkNCg0KdmsgPC0gdmsgJT4lDQogIG11dGF0ZShub19pbmZvID0gaWZlbHNlKG5vX2luZm89PTMsIDEsIDApLCANCiAgICAgICAgIHZlcmtsYXJpbmcgPSBpZmVsc2UodmVya2xhcmluZz09MCwgTkEsIHZlcmtsYXJpbmcpLA0KICAgICAgICAga2VubWVya2VuID0gaWZlbHNlKGtlbm1lcmtlbj09MCwgTkEsIGtlbm1lcmtlbikpDQojIElmIHRoZXJlIGlzIG5vIHRleHQgaW4gdmVya2xhcmluZyBvciBrZW5tZXJrZW4sIHRoZSBuYW1lIGNvdWxkIG5vdCBiZSBmb3VuZCBpbiB0aGUgZGF0YWJhc2VzLiANCmBgYA0KDQoNCiMgRXh0cmFjdGluZyBzcGVjaWZpYyBvcmlnaW4gaW5mb3JtYXRpb24NClRoZXJlIGFyZSB0aHJlZSBtYWluIHdheXMgdG8gZ2V0IGluZm9ybWF0aW9uIGFib3V0IHRoZSBvcmlnaW4gb2YgbGFzdCBuYW1lczoNCg0KMSkgVW5kZXIgImtlbm1lcmtlbiIsIGxhc3QgbmFtZXMgYXJlIGFzc2lnbmVkIGNsaWNrYWJsZSB0YWdzLiBUaGVzZSB0YWdzIGluY2x1ZGUgdW5zcGVjaWZpZWQgZm9yZWlnbiBuYW1lIHRhZ3MgKCJhbmRlcmUgdGFhbCIpLCBhcyB3ZWxsIGFzIHNwZWNpZmljIGZvcmVpZ24gb3JpZ2lucyBvZiB0aGUgbmFtZSAoIkZyYW5zZSBuYWFtIiwgIkluZGlzY2hlIG5hYW0iKS4NCi0+IG9yaWdpbjEgKyBvcmlnaW40DQoNCjIpIFNldmVyYWwgbmFtZXMgaGF2ZSBtb3JlIGV4dGVuc2l2ZWx5IHdyaXR0ZW4gb3V0IHN0b3JpZXMgYmVoaW5kIHRoZSBuYW1lLCB1bmRlciAidmVya2xhcmluZyIuIEEgbnVtYmVyIG9mIG5hbWVzIGNvbnRhaW4gZGV0YWlsZWQgKGVpdGhlciBjb3VudHJ5LWxldmVsIG9yIHJlZ2lvbmFsKSBvcmlnaW5zLCB1c3VhbGx5IGluIHRoZSBmb3JtIG9mICJEZSBuYWFtIFt4eXpdIGlzIGFma29tc3RpZyB1aXQgW2NvdW50cnldIi4gDQotPiBvcmlnaW4yIA0KDQozKSBTb21lIG5hbWVzIGhhdmUgb3JpZ2luIGluZm9ybWF0aW9uIHVuZGVyICJ2ZXJrbGFyaW5nIiBpbiB0aGUgZm9ybSBvZiB0aGUgbGluZ3Vpc3RpYyBvcmlnaW5zIG9mIHRoZSBuYW1lLiBUaGlzIGNhbiBiZSBjb3VudHJ5IHNwZWNpZmljIChlLmcuIENoaW5lc2UgbmFtZSksIGJ1dCBpdCBjYW4gYWxzbyBhcHBseSB0byBtdWx0aXBsZSBjb3VudHJpZXMgd2hlbiB0aGUgbGFuZ3VhZ2UgaXMgc3Bva2VuIGluIG1vcmUgdGhhbiAxIGNvdW50cmllcyAoZS5nLiBTcGFuaXNoIG5hbWUpLiANCi0+IG9yaWdpbjMgDQoNCkluIGhldCBzY3JpcHQgaGllcm9uZGVyIGdhYXQgZXJnZW5zIGlldHMgZm91dC4gRGFhcm9tIGhlYiBpayBldG5pY2l0ZWl0IHVpdGVpbmRlbGlqayBtZXQgZGUgaGFuZCB1aXRnZXJla2VuZC4NCg0KYGBge3IgY291bnRyaWVzLWV4dHJhY3QsIGV2YWw9RkFMU0V9DQoNCiMgU3RlcCAxOiBleHRyYWN0aW5nIG9yaWdpbiB0YWdzIGZyb20ga2VubWVya2VuDQp2ayA8LSB2ayAlPiUNCiAgbXV0YXRlKG9yaWdpbjEgPSBzdHJfZXh0cmFjdChrZW5tZXJrZW4sICJbOnVwcGVyOl0oWzpsb3dlcjpdezIsfSkgbmFhbSIpKQ0KDQojIE5vdGU6IHNvbWV0aW1lcyBtdWx0aXBsZSBvcmlnaW5zIGFyZSBtZW50aW9uZWQuIEN1cnJlbnRseSwgSSBvbmx5IGV4dHJhY3QgdGhlIGZpcnN0IG9uZS4gT3RoZXJ3aXNlLCB3ZSBzaG91bGQgdXNlIHN0cl9leHRyYWN0X2FsbC4gDQoNCg0KDQojIFN0ZXAgMjogZXh0cmFjdGluZyBvcmlnaW4gaW5mbyBmcm9tIHZlcmtsYXJpbmcgDQp2ayA8LSB2ayAlPiUNCiAgbXV0YXRlKG9yaWdpbjIgPSBpZmVsc2UoYXMubnVtZXJpYyhzdHJfZGV0ZWN0KHZlcmtsYXJpbmcsICJhZmtvbXN0aWcgdWl0IikpID09IDEsIA0KICAgICAgICAgc3RyX3JlbW92ZSh2ZXJrbGFyaW5nLCAiLiphZmtvbXN0aWcgdWl0IiksIE5BKSkNCg0KDQojIFN0ZXAgMzogZXh0cmFjdGluZyBhZGRpdGlvbmFsIG9yaWdpbiBpbmZvIGZyb20gdmVya2xhcmluZw0KdmsgPC0gdmsgJT4lDQogIG11dGF0ZShvcmlnaW4zID0gc3RyX2V4dHJhY3QodmVya2xhcmluZywgIls6dXBwZXI6XShbOmxvd2VyOl17Mix9KSAoYWNodGVyKT8oZmFtaWxpZSk/KGJlcm9lcHMpP25hYW0iKSkNCg0KDQoNCiMgRmluYWxseSwgd2UgY2xlYW4gdXAgdGhlIG9yaWdpbiBpbmZvcm1hdGlvbiBleHRyYWN0ZWQgYWJvdmUNCg0KIyBPcmlnaW4xOiBhbHJlYWR5IG5lYXQNCnZrJG9yaWdpbjEgPC0gc3RyX3JlbW92ZSh2ayRvcmlnaW4xLCAiSm9vZHNlIG5hYW0iKSAjIGNhbiBiZSBEdXRjaCAmIG5vbi1EdXRjaA0KDQojIE9yaWdpbjI6IG1lc3N5DQp2ayRvcmlnaW4yIDwtIHN0cl9yZW1vdmUodmskb3JpZ2luMiwgIlxcLi4qIikgIyByZW1vdmUgZXh0cmEgaW5mbyBpbiB0aGUgZm9sbG93aW5nIHNlbnRlbmNlIA0Kdmskb3JpZ2luMiA8LSBzdHJfcmVtb3ZlKHZrJG9yaWdpbjIsICJcXDsuKiIpICMgcmVtb3ZlIGV4dHJhIGluZm8gaW4gdGhlIGZvbGxvd2luZyBzZW50ZW5jZSANCnZrJG9yaWdpbjIgPC0gc3RyX3JlbW92ZSh2ayRvcmlnaW4yLCAiXFwoLioiKSAjIHJlbW92ZSBleHRyYSBpbmZvIGluIHRoZSBmb2xsb3dpbmcgc2VudGVuY2UgDQoNCg0KdmskZHBnIDwtIGFzLm51bWVyaWMoc3RyX2RldGVjdCh2ayRvcmlnaW4yLCAiKGRvcnApfChwbGFhdHMpfChnZW1lZW50ZSl8KGdyYWFmc2NoYXApfChzdGFkKXwoZGVlbCl8KEZyaWVzbGFuZCkiKSkgIyBvcmlnaW4gaW5mbyB0b28gcmVnaW9uYWwgDQp2ayA8LSB2ayAlPiUgbXV0YXRlKG9yaWdpbjIgPSBpZmVsc2UoKGRwZz09MSksIE5BLCBvcmlnaW4yKSkgIyByZW1vdmluZyByZWdpb25hbCBvcmlnaW4gaW5mbw0KdmsgPC0gc3Vic2V0KHZrLCBzZWxlY3QgPSAtZHBnKSAjIHJlbW92aW5nIGludGVybWVkaWF0ZSB2YXJpYWJsZQ0KDQojIFNvbWV0aW1lcywgdGhlcmUgd2VyZSBtdWx0aXBsZSBjb3VudHJpZXMgbWVudGlvbmVkLiBUYWtlIG9ubHkgdGhlIGZpcnN0Og0Kdmskb3JpZ2luMiA8LSBzdHJfcmVtb3ZlKHZrJG9yaWdpbjIsICJcXCwuKiIpICMgT25seSBmaXJzdA0Kdmskb3JpZ2luMiA8LSBzdHJfcmVtb3ZlKHZrJG9yaWdpbjIsICJcXHMoZW4pLioiKSAjIE9ubHkgZmlyc3QgDQp2ayRvcmlnaW4yIDwtIHN0cl9yZW1vdmUodmskb3JpZ2luMiwgIlxccyhvZikuKiIpICMgT25seSBmaXJzdCANCg0KDQojIE9yaWdpbjM6IHByZXR0eSBuZWF0DQp2ayRvcmlnaW4zIDwtIHN0cl9yZW1vdmUodmskb3JpZ2luMywgIkQoaSk/ZSh6ZSk/IChmYW1pbGllKT8oYWNodGVyKT8oYmVyb2Vwcyk/bmFhbSIpICMgc2xpcHBlZCB0aHJvdWdoIHRoZSByZWdleA0Kdmskb3JpZ2luMyA8LSBzdHJfcmVtb3ZlKHZrJG9yaWdpbjMsICJFZW4gKGZhbWlsaWUpPyhhY2h0ZXIpPyhiZXJvZXBzKT9uYWFtIikgIyBzbGlwcGVkIHRocm91Z2ggdGhlIHJlZ2V4DQp2ayRvcmlnaW4zIDwtIHN0cl9yZW1vdmUodmskb3JpZ2luMywgIlppam4gKGZhbWlsaWUpPyhhY2h0ZXIpPyhiZXJvZXBzKT9uYWFtIikgIyBzbGlwcGVkIHRocm91Z2ggdGhlIHJlZ2V4DQp2ayRvcmlnaW4zIDwtIHN0cl9yZW1vdmUodmskb3JpZ2luMywgIkFscyAoZmFtaWxpZSk/KGFjaHRlcik/KGJlcm9lcHMpP25hYW0iKSAjIHNsaXBwZWQgdGhyb3VnaCB0aGUgcmVnZXgNCnZrJG9yaWdpbjMgPC0gc3RyX3JlbW92ZSh2ayRvcmlnaW4zLCAiSm9vZHNlIChmYW1pbGllKT8oYWNodGVyKT9uYWFtIikNCnZrJG9yaWdpbjMgPC0gc3RyX3JlbW92ZSh2ayRvcmlnaW4zLCAiQmlqYmVsc2UgKGZhbWlsaWUpPyhhY2h0ZXIpP25hYW0iKQ0KDQoNCiMgU2V0dGluZyBlbXB0eSBvcmlnaW4gdmFyaWFibGVzIHRvIE5BIChEdXRjaCBvciB1bmZvdW5kIGZvcmVpZ24pDQp2ayA8LSB2ayAlPiUNCiAgbXV0YXRlKG9yaWdpbjEgPSBhcy5jaGFyYWN0ZXIoaWZlbHNlKG9yaWdpbjE9PSIifG9yaWdpbjE9PSJjaGFyYWN0ZXIoMCkiLCBOQSwgb3JpZ2luMSkpLA0KICAgICAgICAgb3JpZ2luMiA9IGFzLmNoYXJhY3RlcihpZmVsc2Uob3JpZ2luMj09IiJ8b3JpZ2luMj09ImNoYXJhY3RlcigwKSIsIE5BLCBvcmlnaW4yKSksDQogICAgICAgICBvcmlnaW4zID0gYXMuY2hhcmFjdGVyKGlmZWxzZShvcmlnaW4zPT0iInxvcmlnaW4zPT0iY2hhcmFjdGVyKDApIiwgTkEsIG9yaWdpbjMpKSkNCg0KDQoNCiMgRmluYWxseSwgdGhlIHRhZyAiYW5kZXJlIHRhYWwiIHdhcyB1c2VkIHRvIGRpc3Rpbmd1aXNoIGZvcmVpZ24gbmFtZXMgb2YgdW5rbm93biBvcmlnaW4gZnJvbSBrbm93biBEdXRjaCBuYW1lcy4gDQp2ayA8LSB2ayAlPiUNCiAgbXV0YXRlKG9yaWdpbjQgPSBpZmVsc2UoKGFzLm51bWVyaWMoc3RyX2RldGVjdChrZW5tZXJrZW4sICJhbmRlcmUgdGFhbCIpKT09MSksICJub24tRHV0Y2giLCBOQSkpDQoNCnZvb3J2b2Vnc2Vsc25sIDwtIGMoIid0IiwgImQnIiwgImRlIiwgImRlIGxhIiwgImRlbiIsICJkZWwiLCAiZGVyIiwgImRlcyIsICJpbiAndCIsICJvcCBkZSIsICJvcCBkZW4iLCAidGVuIiwgInRlciIsICJ0ZXMiLCAidmFuIiwgInZhbiAndCIsICJ2YW4gZGUiICwgInZhbiBkZXIiLCAidmFuIGRlbiIpIA0KDQp2ayRubCA8LSAwDQoNCmZvciAoaSBpbiAxOiBsZW5ndGgodmskbGFzdG5hbWVfZGYubGFzdG5hbWUpKSB7DQogIGlmIChzdW0oc3RyX2RldGVjdChsYXN0bmFtZV9kZiRucFtpXSwgdm9vcnZvZWdzZWxzbmwpKT4wKSB7DQogICAgdmskbmxbaV0gPC0gMQ0KICB9DQp9DQoNCnZrJGR1dGNoIDwtIGlmZWxzZSgoKHZrJG5vX2luZm89PTEgfCB2ayRub19pbmZvPT0ibm9uX0R1dGNoIikgJiAhdmskbmw9PTEpLCAwLCAxKQ0KbmFtZXModmspDQp2ayAlPiUgc2VsZWN0KGMoImxhc3RuYW1lX2RmLmlkIiwgImxhc3RuYW1lX2RmLmxhc3RuYW1lIiwgImR1dGNoIikpDQoNCmBgYA0KDQpgYGB7ciwgZXZhbD1GQUxTRX0NCnNhdmUodmssIGZpbGU9InZrMjAyMjEwMDYuUkRhdGEiKSANCmBgYA0KDQpgYGB7ciwgZXZhbD1GQUxTRX0NCm5hbWVzX2RmJGR1dGNoIDwtIHZrJGR1dGNoDQpgYGANCg0KDQpgYGB7ciwgZXZhbD1GQUxTRX0NCnNhdmUobmFtZXNfZGYsIGZpbGU9Im5hbWVzX2RmX3YyMDIyMTAwNi5SRGF0YSIpIA0KYGBgDQoNCg0KSWsgem91IGFsbGVzIHdhYXIgYG5vX2luZm9gIG9wIDEgc3RhYXQgb2Ygd2FhciBgb3JpZ2luNGAgb3AgIm5vbi1EdXRjaCIgc3RhYXQgY29kZXJlbiBhbHMgYnVpdGVubGFuZHMhIA0KDQoNCg==</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("3.origin.rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
